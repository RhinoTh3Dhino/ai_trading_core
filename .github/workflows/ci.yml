name: CI

on:
  push:
    branches: [ "*" ]
  pull_request:
    branches: [ "*" ]
  workflow_dispatch:

jobs:
  build-and-test:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout kode
      uses: actions/checkout@v4

    - name: Sæt Python op
      uses: actions/setup-python@v5
      with:
        python-version: '3.11'

    - name: Installer pip & afhængigheder
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt

    - name: Kør pytest på tests/
      run: |
        pytest tests/

    # Upload artifacts fra outputs/ og tests/ (fx feature-data, grafer, logs)
    - name: Upload test-artifacts (outputs + tests)
      if: always()  # også ved test-fejl, så du kan debugge!
      uses: actions/upload-artifact@v4
      with:
        name: outputs-and-tests
        path: |
          outputs/
          tests/
          !**/*.pyc
          !**/__pycache__/

    - name: Check struktur og dependencies
      run: echo "✅ Struktur og auto-backup/artifacts OK"

# Bonus: Udvid med lint/format/coverage/artifacts/telegram senere!
